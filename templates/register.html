{% extends "layout.html" %}

{% block title %}Cadastro{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card shadow">
            <div class="card-header bg-danger text-white">
                <h4 class="mb-0">Criar Conta</h4>
            </div>
            <div class="card-body">
                {% if register_success %}
                <div class="alert alert-success" role="alert">Cadastro finalizado</div>
                <div id="dbCounts" class="small text-muted"></div>
                <script>
                fetch('/api/db-counts').then(r => r.json()).then(d => {
                  if (d && d.ok && d.counts) {
                    const c = d.counts;
                    const el = document.getElementById('dbCounts');
                    el.textContent = `Usuários: ${c.users} • Restaurantes: ${c.restaurants} • Itens: ${c.menu_items}`;
                  }
                }).catch(() => {});
                </script>
                {% endif %}
                <form method="POST" action="{{ url_for('register') }}">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="name" class="form-label">Nome Completo</label>
                            <input type="text" class="form-control" id="name" name="name" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3" id="emailGroup">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" class="form-control" id="email" name="email" placeholder="seu@email.com" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="address" class="form-label">Endereço Completo</label>
                        <textarea class="form-control" id="address" name="address" rows="2" required></textarea>
                    </div>
                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-danger">Cadastrar</button>
                        <a href="{{ url_for('google_login', role='customer') }}" class="btn btn-outline-dark"><i class="fab fa-google me-2"></i> Entrar com Google</a>
                        <a href="{{ url_for('google_login', role='customer', force='1') }}" class="btn btn-outline-secondary"><i class="fas fa-user-switch me-2"></i> Entrar com outra conta Google</a>
                    </div>
                </form>
                
            </div>
            <div class="card-footer text-center">
                <p class="mb-0">Já tem uma conta? <a href="{{ url_for('login') }}">Entrar</a></p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
